#!/bin/bash

# Check if the script is run as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run as root or using sudo."
  exit 1
fi

# Set user variable
user=$(cat /home)

# Update package lists
echo "***Updating packages***"
apt update

# Upgrade packages
echo "***Installing updates***"
apt full-upgrade -y

# Install required packages
echo "***Installing additional packages***"
apt install linux-headers-$(uname -r) terminator bloodhound realtek-rtl88xxau-dkms -y

# Remove packages that are no longer required
echo "***Removing packages that are no longer required***"
apt autoremove -y

# Configure SSH
echo "***Configuring SSH access***"
mkdir /home/$user/.ssh
wget https://raw.githubusercontent.com/DaneSerpente/Pentesting/main/Build_Scripts/Files/pentest_rsa.pub -O /home/$user/.ssh/pentest_rsa.pub
sed -i "$38s/.*/PubkeyAuthentication yes/" "/etc/ssh/sshd_config"
sed -i "$57s/.*/PasswordAuthenticaiton no/" "/etc/ssh/sshd_config"
systemctl enable ssh
systemctl start sshS